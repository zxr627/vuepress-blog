import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a as n,o as a}from"./app-BmGZycR1.js";const t={};function l(r,s){return a(),e("div",null,[...s[0]||(s[0]=[n(`<h1 id="redis-å­¦ä¹ å°ç»“-â€”â€”-ä»¥-refresh-token-å­˜å‚¨ä¸ºä¾‹" tabindex="-1"><a class="header-anchor" href="#redis-å­¦ä¹ å°ç»“-â€”â€”-ä»¥-refresh-token-å­˜å‚¨ä¸ºä¾‹"><span>Redis å­¦ä¹ å°ç»“ â€”â€” ä»¥ Refresh Token å­˜å‚¨ä¸ºä¾‹</span></a></h1><h2 id="ğŸ“–-redis-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ğŸ“–-redis-ç®€ä»‹"><span>ğŸ“– Redis ç®€ä»‹</span></a></h2><p>Redisï¼ˆRemote Dictionary Serverï¼‰æ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„é«˜æ€§èƒ½ <strong>é”®å€¼æ•°æ®åº“</strong>ï¼Œä»¥å…¶è¶…å¿«çš„è¯»å†™é€Ÿåº¦ã€ä¸°å¯Œçš„æ•°æ®ç»“æ„å’Œå†…ç½®è¿‡æœŸæœºåˆ¶ï¼Œè¢«å¹¿æ³›åº”ç”¨åœ¨ç¼“å­˜ã€åˆ†å¸ƒå¼å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰åœºæ™¯ä¸­ã€‚</p><p><strong>å¸¸è§åº”ç”¨åœºæ™¯ï¼š</strong></p><ul><li><strong>ç¼“å­˜å±‚</strong>ï¼šå‡å°‘æ•°æ®åº“å‹åŠ›ï¼ŒåŠ å¿«å“åº”é€Ÿåº¦</li><li><strong>åˆ†å¸ƒå¼é”</strong>ï¼šåˆ©ç”¨åŸå­æ“ä½œå®ç°é«˜æ•ˆé”æœºåˆ¶</li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼šé€šè¿‡ <code>list</code> æˆ– <code>stream</code> ä½œä¸ºæ¶ˆæ¯ä¸­è½¬</li><li><strong>Token ç®¡ç†</strong>ï¼šå­˜å‚¨ç”¨æˆ·ç™»å½•çŠ¶æ€å’Œåˆ·æ–°ä»¤ç‰Œï¼ˆRefresh Tokenï¼‰</li></ul><hr><h2 id="ğŸ”‘-ä¸ºä»€ä¹ˆè¦ç”¨-refresh-token" tabindex="-1"><a class="header-anchor" href="#ğŸ”‘-ä¸ºä»€ä¹ˆè¦ç”¨-refresh-token"><span>ğŸ”‘ ä¸ºä»€ä¹ˆè¦ç”¨ Refresh Token</span></a></h2><p>åœ¨ Web ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·è®¤è¯é€šå¸¸ä½¿ç”¨ JWTï¼ˆJSON Web Tokenï¼‰ã€‚</p><p>ä½†å­˜åœ¨ä¸€ä¸ªçŸ›ç›¾ï¼š</p><ul><li><strong>Access Token å¤ªé•¿</strong>ï¼šå®¹æ˜“æ³„éœ²ï¼Œé£é™©é«˜</li><li><strong>Refresh Token å¤ªçŸ­</strong>ï¼šç”¨æˆ·é¢‘ç¹æ‰çº¿ï¼Œä½“éªŒå·®</li></ul><p>ğŸ‘‰ äºæ˜¯å°±æœ‰äº† <strong>åŒ Token æœºåˆ¶</strong>ï¼š</p><ul><li><strong>Access Token</strong>ï¼šçŸ­æœŸæœ‰æ•ˆï¼ˆå¦‚ 15 åˆ†é’Ÿï¼‰ï¼Œç”¨äºæ¥å£è°ƒç”¨è®¤è¯</li><li><strong>Refresh Token</strong>ï¼šé•¿æœŸæœ‰æ•ˆï¼ˆå¦‚ 7 å¤©ï¼‰ï¼Œç”¨äºåˆ·æ–° Access Token</li></ul><p>è¿™æ ·å³ä¾¿ Access Token è¿‡æœŸï¼Œç”¨æˆ·åªè¦ Refresh Token è¿˜æœ‰æ•ˆï¼Œå°±å¯ä»¥â€œæ— æ„Ÿç»­æœŸâ€ï¼Œæå‡ä½“éªŒã€‚</p><hr><h2 id="ğŸ“¦-ä¸ºä»€ä¹ˆé€‰æ‹©-redis-å­˜å‚¨-refresh-token" tabindex="-1"><a class="header-anchor" href="#ğŸ“¦-ä¸ºä»€ä¹ˆé€‰æ‹©-redis-å­˜å‚¨-refresh-token"><span>ğŸ“¦ ä¸ºä»€ä¹ˆé€‰æ‹© Redis å­˜å‚¨ Refresh Token</span></a></h2><ul><li><strong>é«˜æ€§èƒ½</strong>ï¼šRedis åŸºäºå†…å­˜ï¼Œè¯»å†™é€Ÿåº¦æå¿«</li><li><strong>å¤©ç„¶è¿‡æœŸæœºåˆ¶</strong>ï¼šæ”¯æŒ TTLï¼ˆTime To Liveï¼‰ï¼Œä¸ç”¨é¢å¤–å†™æ¸…ç†é€»è¾‘</li><li><strong>é›†ä¸­å¼ç®¡ç†</strong>ï¼šåˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¤šæœåŠ¡å…±äº«åŒä¸€ä»½ Redis</li><li><strong>æ˜“äºæ³¨é”€</strong>ï¼šç”¨æˆ·é€€å‡ºæ—¶ï¼Œç›´æ¥åˆ é™¤ Redis çš„ Key å³å¯</li></ul><hr><h2 id="âš™ï¸-refresh-token-å­˜å‚¨æ€è·¯" tabindex="-1"><a class="header-anchor" href="#âš™ï¸-refresh-token-å­˜å‚¨æ€è·¯"><span>âš™ï¸ Refresh Token å­˜å‚¨æ€è·¯</span></a></h2><ol><li><p>ç”¨æˆ·ç™»å½•æˆåŠŸåï¼š</p><ul><li>ç”Ÿæˆ <strong>Access Token</strong>ï¼ˆçŸ­æœŸï¼‰</li><li>ç”Ÿæˆ <strong>Refresh Token</strong>ï¼ˆé•¿æœŸï¼‰</li><li>å°† Refresh Token å­˜å…¥ Redisï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´</li></ul></li><li><p>ç”¨æˆ·åˆ·æ–° Access Token æ—¶ï¼š</p><ul><li>æ ¡éªŒç”¨æˆ·ä¼ æ¥çš„ Refresh Token æ˜¯å¦å’Œ Redis ä¸­ä¸€è‡´</li><li>å¦‚æœæœ‰æ•ˆ â†’ ç”Ÿæˆæ–°çš„ Access Token</li><li>å¦‚æœæ— æ•ˆ / è¿‡æœŸ â†’ è¦æ±‚é‡æ–°ç™»å½•</li></ul></li></ol><hr><h2 id="ğŸ“-redis-å­˜å‚¨ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ğŸ“-redis-å­˜å‚¨ç¤ºä¾‹"><span>ğŸ“ Redis å­˜å‚¨ç¤ºä¾‹</span></a></h2><p>å¸¸è§çš„å­˜å‚¨æ–¹å¼ï¼š<strong>ç”¨æˆ· ID ä½œä¸º key</strong>ï¼ŒRefresh Token ä½œä¸º valueã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">SETEX</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> refresh_token:123</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 604800</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;eyJhbGciOiJIUzI1NiIs...&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">\`\`\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">javascript</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">const</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> Redis = require(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">&#39;ioredis&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">const</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> redis = new Redis();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> ä¿å­˜ Refresh Tokenï¼ˆ7 å¤©æœ‰æ•ˆæœŸï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">async</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> function saveRefreshToken(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">userId,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> token) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  await</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> redis.set(\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">refresh_token:$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">{userId}\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> token, &quot;EX&quot;, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 60</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 60</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> æ ¡éªŒ Refresh Token æ˜¯å¦æœ‰æ•ˆ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">async</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> function verifyRefreshToken(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">userId,</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> token) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  const</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> storedToken = await redis.get(\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">refresh_token:$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">{userId}\`);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> storedToken === token;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">//</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> åˆ é™¤ Refresh Tokenï¼ˆç”¨æˆ·ç™»å‡ºï¼‰</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">async</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> function deleteRefreshToken(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">userId</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">  await</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> redis.del(\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">refresh_token:$</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">{userId}\`);</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,23)])])}const p=i(t,[["render",l],["__file","index.html.vue"]]),d=JSON.parse(`{"path":"/Database/NoSQL/","title":"Redis å­¦ä¹ å°ç»“ â€”â€” ä»¥ Refresh Token å­˜å‚¨ä¸ºä¾‹","lang":"zh-CN","frontmatter":{"order":7,"date":"2025-09-11T00:00:00.000Z","category":["Redis"],"description":"Redis å­¦ä¹ å°ç»“ â€”â€” ä»¥ Refresh Token å­˜å‚¨ä¸ºä¾‹ ğŸ“– Redis ç®€ä»‹ Redisï¼ˆRemote Dictionary Serverï¼‰æ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„é«˜æ€§èƒ½ é”®å€¼æ•°æ®åº“ï¼Œä»¥å…¶è¶…å¿«çš„è¯»å†™é€Ÿåº¦ã€ä¸°å¯Œçš„æ•°æ®ç»“æ„å’Œå†…ç½®è¿‡æœŸæœºåˆ¶ï¼Œè¢«å¹¿æ³›åº”ç”¨åœ¨ç¼“å­˜ã€åˆ†å¸ƒå¼å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰åœºæ™¯ä¸­ã€‚ å¸¸è§åº”ç”¨åœºæ™¯ï¼š ç¼“å­˜å±‚ï¼šå‡å°‘æ•°æ®åº“å‹åŠ›ï¼ŒåŠ å¿«å“åº”é€Ÿåº¦ åˆ†å¸ƒå¼é”...","head":[["meta",{"property":"og:url","content":"https://zxroo.top/Database/NoSQL/"}],["meta",{"property":"og:site_name","content":"Zxr's Blog"}],["meta",{"property":"og:title","content":"Redis å­¦ä¹ å°ç»“ â€”â€” ä»¥ Refresh Token å­˜å‚¨ä¸ºä¾‹"}],["meta",{"property":"og:description","content":"Redis å­¦ä¹ å°ç»“ â€”â€” ä»¥ Refresh Token å­˜å‚¨ä¸ºä¾‹ ğŸ“– Redis ç®€ä»‹ Redisï¼ˆRemote Dictionary Serverï¼‰æ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„é«˜æ€§èƒ½ é”®å€¼æ•°æ®åº“ï¼Œä»¥å…¶è¶…å¿«çš„è¯»å†™é€Ÿåº¦ã€ä¸°å¯Œçš„æ•°æ®ç»“æ„å’Œå†…ç½®è¿‡æœŸæœºåˆ¶ï¼Œè¢«å¹¿æ³›åº”ç”¨åœ¨ç¼“å­˜ã€åˆ†å¸ƒå¼å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰åœºæ™¯ä¸­ã€‚ å¸¸è§åº”ç”¨åœºæ™¯ï¼š ç¼“å­˜å±‚ï¼šå‡å°‘æ•°æ®åº“å‹åŠ›ï¼ŒåŠ å¿«å“åº”é€Ÿåº¦ åˆ†å¸ƒå¼é”..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-10-16T10:02:44.000Z"}],["meta",{"property":"article:published_time","content":"2025-09-11T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-10-16T10:02:44.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Redis å­¦ä¹ å°ç»“ â€”â€” ä»¥ Refresh Token å­˜å‚¨ä¸ºä¾‹\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-09-11T00:00:00.000Z\\",\\"dateModified\\":\\"2025-10-16T10:02:44.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"ğŸ“– Redis ç®€ä»‹","slug":"ğŸ“–-redis-ç®€ä»‹","link":"#ğŸ“–-redis-ç®€ä»‹","children":[]},{"level":2,"title":"ğŸ”‘ ä¸ºä»€ä¹ˆè¦ç”¨ Refresh Token","slug":"ğŸ”‘-ä¸ºä»€ä¹ˆè¦ç”¨-refresh-token","link":"#ğŸ”‘-ä¸ºä»€ä¹ˆè¦ç”¨-refresh-token","children":[]},{"level":2,"title":"ğŸ“¦ ä¸ºä»€ä¹ˆé€‰æ‹© Redis å­˜å‚¨ Refresh Token","slug":"ğŸ“¦-ä¸ºä»€ä¹ˆé€‰æ‹©-redis-å­˜å‚¨-refresh-token","link":"#ğŸ“¦-ä¸ºä»€ä¹ˆé€‰æ‹©-redis-å­˜å‚¨-refresh-token","children":[]},{"level":2,"title":"âš™ï¸ Refresh Token å­˜å‚¨æ€è·¯","slug":"âš™ï¸-refresh-token-å­˜å‚¨æ€è·¯","link":"#âš™ï¸-refresh-token-å­˜å‚¨æ€è·¯","children":[]},{"level":2,"title":"ğŸ“ Redis å­˜å‚¨ç¤ºä¾‹","slug":"ğŸ“-redis-å­˜å‚¨ç¤ºä¾‹","link":"#ğŸ“-redis-å­˜å‚¨ç¤ºä¾‹","children":[]}],"git":{"createdTime":1757488086000,"updatedTime":1760608964000,"contributors":[{"name":"zhaoxinrong","email":"â€œzhaoxr@cwanwu.comâ€","commits":7}]},"readingTime":{"minutes":1.85,"words":556},"filePathRelative":"Database/NoSQL/README.md","localizedDate":"2025å¹´9æœˆ11æ—¥","excerpt":"","autoDesc":true}`);export{p as comp,d as data};
